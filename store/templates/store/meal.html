{% extends 'store/main.html' %}
{% load static %}

{% block content %}
<div class="container">
    <h1>Przepis na tą chwilę</h1>
    <div id="recipeDisplay"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    loadRandomRecipe();
});

function loadRandomRecipe() {
    fetch('https://www.themealdb.com/api/json/v1/1/random.php')
        .then(response => response.json())
        .then(data => {
            displayRecipe(data.meals[0]);
        })
        .catch(error => {
            console.error('Error fetching data: ', error);
            alert('Nie można załadować przepisu');
        });
}

function displayRecipe(meal) {
    const display = document.getElementById('recipeDisplay');
    display.innerHTML = `
        <h2>${meal.strMeal}</h2>
        <p><strong>Kategoria:</strong> ${meal.strCategory}</p>
        <p><strong>Pochodzenie:</strong> ${meal.strArea}</p>
        <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
        <h3>Instrukcje:</h3>
        <p>${meal.strInstructions.replace(/\r\n/g, '<br>')}</p>
        <h3>Składniki:</h3>
        <ul>${generateIngredientsList(meal)}</ul>
    `;
}

function generateIngredientsList(meal) {
    let ingredientsList = '';
    for (let i = 1; i <= 20; i++) {
        if (meal[`strIngredient${i}`]) {
            ingredientsList += `<li>${meal[`strIngredient${i}`]} - ${meal[`strMeasure${i}`]}</li>`;
        }
    }
    return ingredientsList;
}
</script>

<style>
    body { font-family: Arial, sans-serif; }
    .container { max-width: 800px; margin: auto; }
    img { max-width: 100%; height: auto; }
    ul { list-style-type: none; }
    li { margin-bottom: 10px; }
</style>

</div>
{% endblock content %}
